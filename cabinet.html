<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет - Language School</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="alert-container" class="alert-container"></div>
    <nav class="navbar navbar-expand-lg navbar-purple">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <svg class="logo-icon me-2" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="32" height="32" rx="6" fill="white"/>
                    <circle cx="10" cy="16" r="4" fill="#6f42c1"/>
                    <circle cx="22" cy="16" r="4" fill="#6f42c1"/>
                    <path d="M14 16L18 16" stroke="#6f42c1" stroke-width="2"/>
                </svg>
                <span class="brand-text">Language School</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link nav-link-purple" href="index.html">Главная</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-purple" href="#contacts">Контакты</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-cabinet" href="cabinet.html">Личный кабинет</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="py-5">
        <div class="container">
            <h2 class="text-center fw-bold mb-5">Мои заявки</h2>
            <div class="table-responsive">
                <table class="table table-hover orders-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Курс/Репетитор</th>
                            <th>Дата</th>
                            <th>Время</th>
                            <th>Длительность</th>
                            <th>Стоимость</th>
                            <th>Опции</th>
                            <th>Подробнее</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table-body"></tbody>
                </table>
            </div>
            <div id="no-orders-message" class="text-center py-5 d-none">
                <div class="card border-0 shadow-sm">
                    <div class="card-body py-5">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#6f42c1" stroke-width="1.5" class="mb-3">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        <h4 class="fw-bold mb-2">У вас пока нет заявок</h4>
                        <p class="text-muted mb-3">Перейдите на главную страницу, чтобы выбрать курс или репетитора</p>
                        <a href="index.html" class="btn btn-primary">Выбрать курс</a>
                    </div>
                </div>
            </div>
            <div id="orders-pagination" class="mt-4"></div>
        </div>
    </section>

    <footer id="contacts" class="py-4 bg-black text-white">
        <div class="container text-center">
            <p class="mb-0">&copy; 2024 Language School. Все права защищены.</p>
            <p class="mb-0">Наш email: <a href="mailto:info@language-school.ru">info@language-school.ru</a></p>
            <p class="mb-0">Наш телефон: <a href="tel:+79990000000">+7 999 000-00-00</a></p>
            <p class="mb-0">Часы работы: 10.00-20.00. ПН-ВС.</p>
            <div class="footer-social-links">
                <a href="#" class="social-link" title="VK">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.373 0 0 4.974 0 11.111c0 4.523 2.385 8.449 6.075 10.723.35.086.692.001 1-.26.257-.216 3.263-2.198 3.763-2.485.167-.096.269-.143.37.108.073.18.754 1.72 1.052 2.354.097.207.187.414.268.636.257.707.479 1.438.67 2.182.063.244.125.484.185.725.193.776-1.024 1.585-1.617 1.602-.243.007-.502-.08-.762-.2-.385-.178-2.633-1.29-7.066-1.29-3.05 0-5.657 1.82-6.378 2.082-.72.263-1.305.127-1.58-.24-.274-.366-2.64-3.186-2.7-5.2-.008-.266-.017-.533-.017-.8C2.2 5.373 6.626.4 12.001.4c5.364 0 9.8 4.973 9.8 11.11 0 6.136-4.436 11.11-9.8 11.11-2.57 0-4.977-.93-6.772-2.48-.56-.485-.996-1.155-1.283-1.93-.287-.775-.18-1.575.31-2.235.49-.66 2.79-2.85 2.79-2.85.412-.39.63-.916.576-1.47l-.23-2.57c-.097-.56-.36-1.17-.72-1.5-.36-.33-1.05-.5-1.7-.37-1.08.21-2.24 1.23-2.85 2.08-.61.85-1.21 2.4-1.33 2.71-.12.31-.38.65-.77.78l-2.41.01c-.54 0-.83-.39-.83-.78 0-2.15 1.17-6.15 1.17-6.15.67-1.35 1.01-2.57 1.26-3.47.25-.9.52-1.82.91-2.52.39-.7.97-1.18 1.68-1.35.71-.17 1.21-.12 1.71-.12.5 0 1.39.02 2.04.43.65.41 2.48 2.38 2.89 3.21.41.83.81 2.21.81 2.21l.31.24c.61.5 1.18.92 1.67 1.33.49.41 1.03.81 1.68.8.65-.01 1.22-.43 1.66-.96.44-.53 2.08-2.49 2.38-3.13.3-.64.6-1.32 1.17-1.98.57-.66 1.23-1.15 1.81-1.56.58-.41 1.17-.71 1.8-.91.63-.2 1.33-.3 2.05-.3h.64c.72 0 1.41.1 2.03.31.62.21 1.19.54 1.67.97.48.43.88.95 1.17 1.58.29.63.44 1.35.44 2.11 0 .76-.15 1.57-.44 2.33-.29.76-.68 1.47-1.17 2.08-.49.61-1.08 1.12-1.74 1.52-.66.4-1.38.7-2.12.88-.74.18-1.51.26-2.28.26h-.29c-.77 0-1.54-.08-2.29-.26-.75-.18-1.45-.49-2.09-.9-.64-.41-1.2-.95-1.64-1.58-.44-.63-.79-1.35-1.04-2.12-.25-.77-.37-1.59-.37-2.42 0-.83.12-1.65.37-2.42.25-.77.6-1.49 1.04-2.12.44-.63 1-1.17 1.64-1.58.64-.41 1.34-.72 2.09-.9.75-.18 1.52-.26 2.29-.26h.58c.51 0 1.01.05 1.49.14.48.09.93.23 1.34.42.41.19.78.43 1.11.72.33.29.61.61.85.97.24.36.43.75.57 1.17.14.42.21.86.21 1.31 0 .45-.07.89-.21 1.31-.14.42-.33.81-.57 1.17-.24.36-.52.68-.85.97-.33.29-.7.53-1.11.72-.41.19-.83.33-1.34.42-.48.09-.98.14-1.49.14h-1.14c-.51 0-1.01-.05-1.49-.14-.48-.09-.93-.23-1.34-.42-.41-.19-.78-.43-1.11-.72-.33-.29-.61-.61-.85-.97-.24-.36-.43-.75-.57-1.17-.14-.42-.21-.86-.21-1.31 0-.45.07-.89.21-1.31.14-.42.33-.81.57-1.17.24-.36.52-.68.85-.97.33-.29.7-.53 1.11-.72.41-.19.86-.33 1.34-.42.48-.09.98-.14 1.49-.14h1.37c.29 0 .57.02.84.06.27.04.53.1.77.18.24.08.47.18.68.3.21.12.4.26.57.43.17.17.31.36.43.57.12.21.21.44.27.69.06.25.09.51.09.78 0 .27-.03.53-.09.78-.06.25-.15.48-.27.69-.12.21-.26.4-.43.57-.17.17-.36.31-.57.43-.21.12-.44.22-.68.3-.24.08-.5.14-.77.18-.27.04-.55.06-.84.06z"/></svg>
                </a>
                <a href="#" class="social-link" title="Telegram">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
                </a>
            </div>
        </div>
    </footer>

    <div class="modal fade" id="orderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderModalTitle">Оформление заявки</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="order-form">
                        <input type="hidden" id="order-id">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="tutor_id" class="form-label">Репетитор</label>
                                <select class="form-select" id="tutor_id" name="tutor_id">
                                    <option value="">Выберите репетитора</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="course_id" class="form-label">Курс</label>
                                <select class="form-select" id="course_id" name="course_id">
                                    <option value="">Выберите курс</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="date_start" class="form-label">Дата начала</label>
                                <input type="date" class="form-control" id="date_start" name="date_start" required>
                            </div>
                            <div class="col-md-4">
                                <label for="time_start" class="form-label">Время</label>
                                <input type="time" class="form-control" id="time_start" name="time_start" required>
                            </div>
                            <div class="col-md-4">
                                <label for="duration" class="form-label">Длительность (часы)</label>
                                <input type="number" class="form-control" id="duration" name="duration" min="1" max="40">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="persons" class="form-label">Количество человек</label>
                                <input type="number" class="form-control" id="persons" name="persons" min="1" max="20" required>
                            </div>
                        </div>
                        <div class="tutor-cost-display" id="tutor-cost-section" style="display: none;">
                            <div class="tutor-cost-label">Стоимость занятия</div>
                            <div class="tutor-cost-value" id="tutor-total-cost">0 ₽</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary" id="order-submit-btn" onclick="submitOrder()">Отправить</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="courseApplicationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content application-modal">
                <div class="modal-header">
                    <h5 class="modal-title">Подача заявки на курс</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="course-application-form">
                        <input type="hidden" id="application-course-id">
                        <input type="hidden" id="application-tutor-id">
                        
                        <div class="application-form-section">
                            <div class="application-form-section-title">Информация о курсе</div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="application-course-name" class="form-label">Название курса</label>
                                    <input type="text" class="form-control" id="application-course-name" readonly>
                                </div>
                                <div class="col-md-6">
                                    <label for="application-teacher" class="form-label">Преподаватель</label>
                                    <input type="text" class="form-control" id="application-teacher" readonly>
                                </div>
                            </div>
                            <div class="course-duration-info mt-3">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="duration-label">Продолжительность</div>
                                        <div class="duration-value" id="application-duration">-</div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="duration-label">Часов в неделю</div>
                                        <div class="duration-value" id="application-week-length">-</div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="duration-label">Дата окончания</div>
                                        <div class="duration-value end-date" id="application-end-date">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="application-form-section">
                            <div class="application-form-section-title">Расписание занятий</div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="application-date-start" class="form-label">Дата начала курса</label>
                                    <select class="form-select" id="application-date-start">
                                        <option value="">Выберите дату</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="application-time-start" class="form-label">Время занятия</label>
                                    <select class="form-select" id="application-time-start" disabled>
                                        <option value="">Сначала выберите дату</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="application-form-section">
                            <div class="application-form-section-title">Параметры заявки</div>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="application-students" class="form-label">Количество студентов в группе</label>
                                    <input type="number" class="form-control" id="application-students" min="1" max="20" value="1">
                                    <div class="form-text">От 1 до 20 человек</div>
                                </div>
                            </div>
                        </div>

                        <div class="application-form-section">
                            <div class="application-form-section-title">Дополнительные опции</div>
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-early-registration" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-early-registration">Ранняя регистрация (скидка 10%)</label>
                                        <div class="form-text text-muted small">При регистрации за месяц вперед</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-group-enrollment" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-group-enrollment">Групповая запись (скидка 15%)</label>
                                        <div class="form-text text-muted small">Для групп от 5 человек</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-intensive-course" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-intensive-course">Интенсивный курс (+20%)</label>
                                        <div class="form-text text-muted small">5 и более часов в неделю</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-supplementary" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-supplementary">Дополнительные материалы (+2000₽/студент)</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-personalized" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-personalized">Индивидуальные занятия (+1500₽/неделю)</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-excursions" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-excursions">Культурные экскурсии (+25%)</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-assessment" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-assessment">Оценка уровня языка (+300₽)</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="opt-interactive" onchange="calculateTotalCost()">
                                        <label class="form-check-label" for="opt-interactive">Интерактивная платформа (+50%)</label>
                                    </div>
                                </div>
                            </div>
                            <div id="applied-options" class="mt-3"></div>
                        </div>

                        <div class="cost-display">
                            <div class="cost-label">Общая стоимость курса</div>
                            <div class="cost-value" id="application-total-cost">0 ₽</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary" onclick="submitCourseApplication()">Отправить заявку</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Подтверждение удаления</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-0">Вы уверены, что хотите удалить заявку?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Нет</button>
                    <button type="button" class="btn btn-danger" id="delete-confirm-btn" onclick="confirmDelete()">Да</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Детали заявки</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="details-modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/cabinet.js"></script>
</body>
</html>

